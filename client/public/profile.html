<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JHUB Africa - My Profile</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Reusing dashboard styles with additions */
        :root {
            --primary-color: #003399;
            --secondary-color: #0055ff;
            --accent-color: #00d084;
            --light-bg: #f4f5f6;
            --dark-text: #000a1f;
        }
        
        /* Profile-specific styles */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 30px;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        
        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .profile-info h1 {
            margin: 0;
            color: var(--dark-text);
        }
        
        .profile-info p {
            margin: 5px 0 0;
            color: #666;
        }
        
        .profile-stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        
        .profile-stat {
            text-align: center;
        }
        
        .profile-stat h3 {
            margin: 0;
            color: var(--primary-color);
        }
        
        .profile-stat p {
            margin: 5px 0 0;
            font-size: 0.9rem;
        }
        
        .profile-edit-btn {
            background-color: var(--light-bg);
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            margin-left: auto;
            align-self: flex-start;
        }
        
        .profile-edit-btn:hover {
            background-color: #e0e0e0;
        }
        
        .profile-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .detail-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        
        .detail-card h2 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 1.3rem;
        }
        
        .detail-row {
            display: flex;
            margin-bottom: 15px;
        }
        
        .detail-label {
            width: 150px;
            font-weight: 600;
            color: var(--dark-text);
        }
        
        .detail-value {
            flex: 1;
            color: #555;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .profile-header {
                flex-direction: column;
                text-align: center;
            }
            
            .profile-stats {
                justify-content: center;
            }
            
            .profile-edit-btn {
                margin-left: 0;
                align-self: center;
            }
            
            .profile-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation (same as dashboard) -->
    <nav class="navbar">
        <div class="logo">
            <img src="images/logo.png" alt="JHUB Africa">
            <span class="logo-text">JHUB Africa</span>
        </div>
        
        <div class="nav-links">
            <a href="courses.html">Courses</a>
            <a href="dashboard.html">Dashboard</a>
            <a href="leaderboard.html">Leaderboard</a>
            <a href="rewards.html">Rewards</a>
            <a href="profile.html" class="active">Profile</a>
        </div>
        
        <div class="user-menu">
            <div class="user-avatar">JS</div>
        </div>
    </nav>
    
    <!-- Dashboard Layout -->
    <div class="dashboard-container">
        <!-- Sidebar (same as dashboard) -->
        <div class="sidebar">
            <ul class="sidebar-menu">
                <li><a href="dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href="my-courses.html"><i class="fas fa-book-open"></i> My Courses</a></li>
                <li><a href="achievements.html"><i class="fas fa-trophy"></i> Achievements</a></li>
                <li><a href="points.html"><i class="fas fa-coins"></i> Points Wallet</a></li>
                <li><a href="referrals.html"><i class="fas fa-user-plus"></i> Refer Friends</a></li>
                <li><a href="settings.html"><i class="fas fa-cog"></i> Settings</a></li>
                <li><a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Profile Header -->
            <div class="profile-header">
                <div class="profile-avatar">JS</div>
                <div class="profile-info">
                    <h1>Jane Student</h1>
                    <p>Level 3 Explorer | Joined March 2023</p>
                    
                    <div class="profile-stats">
                        <div class="profile-stat">
                            <h3>1,250</h3>
                            <p>XP Points</p>
                        </div>
                        <div class="profile-stat">
                            <h3>3</h3>
                            <p>Courses</p>
                        </div>
                        <div class="profile-stat">
                            <h3>5</h3>
                            <p>Referrals</p>
                        </div>
                    </div>
                </div>
                <button class="profile-edit-btn" onclick="window.location.href='settings.html'">
                    <i class="fas fa-edit"></i> Edit Profile
                </button>
            </div>
            
            <!-- Profile Details -->
            <div class="profile-details">
                <div class="detail-card">
                    <h2>Personal Information</h2>
                    
                    <div class="detail-row">
                        <div class="detail-label">Full Name</div>
                        <div class="detail-value">Jane Student</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Email</div>
                        <div class="detail-value">jane.student@example.com</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Phone</div>
                        <div class="detail-value">+254 712 345 678</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Location</div>
                        <div class="detail-value">Nairobi, Kenya</div>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h2>Learning Progress</h2>
                    
                    <div class="detail-row">
                        <div class="detail-label">Current Level</div>
                        <div class="detail-value">3 Explorer</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">XP Points</div>
                        <div class="detail-value">1,250 / 2,000 to next level</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Courses Completed</div>
                        <div class="detail-value">3 of 12</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Achievements</div>
                        <div class="detail-value">2 unlocked</div>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h2>Referral Program</h2>
                    
                    <div class="detail-row">
                        <div class="detail-label">Your Referral Code</div>
                        <div class="detail-value">
                            <strong>JANE1234</strong>
                            <button onclick="copyReferralCode()" style="margin-left: 10px; padding: 3px 8px; font-size: 0.8rem;">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Friends Referred</div>
                        <div class="detail-value">5</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Referral Points</div>
                        <div class="detail-value">500 XP</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Referral Link</div>
                        <div class="detail-value">
                            <input type="text" id="referralLink" value="https://jhubafrica.com/register?ref=JANE1234" 
                                   readonly style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 3px;">
                        </div>
                    </div>
                </div>
                
                <div class="detail-card">
                    <h2>Account Security</h2>
                    
                    <div class="detail-row">
                        <div class="detail-label">Password</div>
                        <div class="detail-value">
                            ********
                            <a href="change-password.html" style="margin-left: 10px;">Change</a>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Two-Factor Auth</div>
                        <div class="detail-value">
                            Not enabled
                            <a href="settings.html#security" style="margin-left: 10px;">Enable</a>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Last Login</div>
                        <div class="detail-value">Today at 10:30 AM</div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-label">Account Status</div>
                        <div class="detail-value">Active</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Logout functionality
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('authToken');
                window.location.href = 'login.html';
            });
            
            // Copy referral code
            window.copyReferralCode = function() {
                const referralLink = document.getElementById('referralLink');
                referralLink.select();
                document.execCommand('copy');
                alert('Referral link copied to clipboard!');
            };
            
            // Load user data (mock implementation)
            function loadUserData() {
                // In a real app, this would come from your API
                const userData = {
                    name: "Jane Student",
                    email: "jane.student@example.com",
                    phone: "+254 712 345 678",
                    location: "Nairobi, Kenya",
                    level: 3,
                    points: 1250,
                    nextLevel: 2000,
                    coursesCompleted: 3,
                    totalCourses: 12,
                    achievements: 2,
                    referralCode: "JANE1234",
                    referrals: 5,
                    referralPoints: 500,
                    lastLogin: "Today at 10:30 AM"
                };
                
                // Update profile header
                document.querySelector('.profile-avatar').textContent = 
                    userData.name.split(' ').map(n => n[0]).join('').toUpperCase();
                document.querySelector('.profile-info h1').textContent = userData.name;
                document.querySelector('.profile-info p').textContent = 
                    `Level ${userData.level} Explorer | Joined March 2023`;
                
                // Update stats
                document.querySelectorAll('.profile-stat h3')[0].textContent = 
                    userData.points.toLocaleString();
                document.querySelectorAll('.profile-stat h3')[1].textContent = 
                    userData.coursesCompleted;
                document.querySelectorAll('.profile-stat h3')[2].textContent = 
                    userData.referrals;
                
                // Update personal info
                document.querySelectorAll('.detail-value')[1].textContent = userData.email;
                document.querySelectorAll('.detail-value')[2].textContent = userData.phone;
                document.querySelectorAll('.detail-value')[3].textContent = userData.location;
                
                // Update learning progress
                document.querySelectorAll('.detail-value')[5].textContent = 
                    `${userData.points.toLocaleString()} / ${userData.nextLevel.toLocaleString()} to next level`;
                document.querySelectorAll('.detail-value')[7].textContent = 
                    `${userData.coursesCompleted} of ${userData.totalCourses}`;
                document.querySelectorAll('.detail-value')[9].textContent = 
                    `${userData.achievements} unlocked`;
                
                // Update referral info
                document.querySelectorAll('.detail-value')[11].innerHTML = 
                    `<strong>${userData.referralCode}</strong>`;
                document.querySelectorAll('.detail-value')[13].textContent = 
                    userData.referrals;
                document.querySelectorAll('.detail-value')[15].textContent = 
                    `${userData.referralPoints.toLocaleString()} XP`;
                document.getElementById('referralLink').value = 
                    `https://jhubafrica.com/register?ref=${userData.referralCode}`;
                
                // Update security info
                document.querySelectorAll('.detail-value')[19].textContent = 
                    userData.lastLogin;
            }
            
            loadUserData();
        });
    </script>
    <script>
  document.addEventListener('DOMContentLoaded', function () {
    const token = localStorage.getItem('authToken');
    if (!token) {
      window.location.href = 'login.html';
      return;
    }

    // OPTIONAL: Fetch user data and update UI
    fetch('http://localhost:5000/api/auth/me', {
      method: 'GET',
      headers: {
        'Authorization': 'Bearer ' + token
      }
    })
    .then(res => {
      if (!res.ok) throw new Error('Unauthorized');
      return res.json();
    })
    .then(user => {
      console.log('User data:', user);
      // Example UI update (add these IDs in your HTML if you want to use them):
      // document.getElementById('profileName').textContent = user.name;
      // document.getElementById('profileEmail').textContent = user.email;
    })
    .catch(err => {
      console.error(err);
      localStorage.removeItem('authToken');
      window.location.href = 'login.html';
    });

    // Logout functionality
    const logoutBtn = document.getElementById('logoutBtn');
    if (logoutBtn) {
      logoutBtn.addEventListener('click', function (e) {
        e.preventDefault();
        localStorage.removeItem('authToken');
        window.location.href = 'login.html';
      });
    }
  });
</script>

<script src="/js/apiConnector.js"></script>
<script>
  (async function() {
    try {
      // Load user data
      const user = await JHubAPI.getCurrentUser();
      
      // Populate profile
      document.getElementById('profile-name').textContent = user.name;
      document.getElementById('profile-email').textContent = user.email;
      document.getElementById('profile-points').textContent = user.points || 0;
      
      // Handle profile updates
      document.getElementById('update-profile').addEventListener('submit', async (e) => {
        e.preventDefault();
        const updates = {
          name: document.getElementById('name').value,
          bio: document.getElementById('bio').value
        };
        await JHubAPI.updateUser(user._id, updates);
        alert('Profile updated successfully!');
      });
      
    } catch (error) {
      console.error('Profile load failed:', error);
      window.location.href = '/login.html';
    }
  })();
</script>
</body>
</html>